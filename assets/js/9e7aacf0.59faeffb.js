"use strict";(self.webpackChunkfrontend_notes=self.webpackChunkfrontend_notes||[]).push([[2455],{7875:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var s=e(4848),t=e(8453);const i={},a="webpack",c={id:"webpack\u76f8\u5173/\u57fa\u7840\u77e5\u8bc6",title:"webpack",description:"webpack \u662f\u4e00\u4e2a\u524d\u7aef\u6253\u5305\u5de5\u5177\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u628a\u591a\u4e2a js \u6587\u4ef6\u5408\u5e76\u6210\u4e00\u4e2a js \u6587\u4ef6\uff0c\u51cf\u5c11 http \u8bf7\u6c42\uff0c\u63d0\u9ad8\u9875\u9762\u52a0\u8f7d\u901f\u5ea6\u3002",source:"@site/docs/webpack\u76f8\u5173/\u57fa\u7840\u77e5\u8bc6.md",sourceDirName:"webpack\u76f8\u5173",slug:"/webpack\u76f8\u5173/\u57fa\u7840\u77e5\u8bc6",permalink:"/docs/webpack\u76f8\u5173/\u57fa\u7840\u77e5\u8bc6",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/webpack\u76f8\u5173/\u57fa\u7840\u77e5\u8bc6.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"npm install \u7684\u4e0d\u540c\u9009\u9879\uff1a--save\u3001--save-dev\u3001-S\u3001-D \u7684\u533a\u522b",permalink:"/docs/nodejs\u76f8\u5173/npm"},next:{title:"husky & lint-staged",permalink:"/docs/\u4ee3\u7801\u63d0\u4ea4\u89c4\u8303/husky"}},o={},l=[{value:"1. \u5b89\u88c5",id:"1-\u5b89\u88c5",level:2},{value:"2. \u914d\u7f6e",id:"2-\u914d\u7f6e",level:2},{value:"1.1. entry \u5165\u53e3",id:"11-entry-\u5165\u53e3",level:3},{value:"webpack.config.js",id:"webpackconfigjs",level:4}];function p(n){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"webpack",children:"webpack"})}),"\n",(0,s.jsx)(r.p,{children:"webpack \u662f\u4e00\u4e2a\u524d\u7aef\u6253\u5305\u5de5\u5177\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u628a\u591a\u4e2a js \u6587\u4ef6\u5408\u5e76\u6210\u4e00\u4e2a js \u6587\u4ef6\uff0c\u51cf\u5c11 http \u8bf7\u6c42\uff0c\u63d0\u9ad8\u9875\u9762\u52a0\u8f7d\u901f\u5ea6\u3002"}),"\n",(0,s.jsx)(r.h2,{id:"1-\u5b89\u88c5",children:"1. \u5b89\u88c5"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.code,{children:"npm install webpack webpack-cli -D"})}),"\n",(0,s.jsx)(r.h2,{id:"2-\u914d\u7f6e",children:"2. \u914d\u7f6e"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"// webpack.config.js\r\n\r\nconst path = require('path') //nodejs\u6a21\u5757 \u5904\u7406\u8def\u5f84\u7684\r\n\r\n// \u57fa\u672c\u6846\u67b6\r\nmodule.exports = {\r\n  entry: '', //\u5165\u53e3\u6587\u4ef6\r\n  output: {}, //\u51fa\u53e3\u6587\u4ef6\r\n  module: {}, //loader \u914d\u7f6e\r\n  plugins: [], //\u63d2\u4ef6\u914d\u7f6e\r\n  devServer: {} //\u5f00\u53d1\u670d\u52a1\u5668\u914d\u7f6e\r\n  mode: 'development' //\u5f00\u53d1\u6a21\u5f0f\r\n  devtool: 'source-map'//\u6e90\u4ee3\u7801\u6620\u5c04\r\n}\n"})}),"\n",(0,s.jsx)(r.h3,{id:"11-entry-\u5165\u53e3",children:"1.1. entry \u5165\u53e3"}),"\n",(0,s.jsx)(r.p,{children:"\u5165\u53e3\u8d77\u70b9(entry point) \u6307\u793a webpack \u5e94\u8be5\u4f7f\u7528\u54ea\u4e2a\u6a21\u5757\uff0c\u6765\u4f5c\u4e3a\u6784\u5efa\u5176\u5185\u90e8 \u4f9d\u8d56\u56fe(dependency graph) \u7684\u5f00\u59cb\u3002\u8fdb\u5165\u5165\u53e3\u8d77\u70b9\u540e\uff0cwebpack \u4f1a\u627e\u51fa\u6709\u54ea\u4e9b\u6a21\u5757\u548c\u5e93\u662f\u5165\u53e3\u8d77\u70b9\uff08\u76f4\u63a5\u548c\u95f4\u63a5\uff09\u4f9d\u8d56\u7684\u3002"}),"\n",(0,s.jsxs)(r.p,{children:["\u9ed8\u8ba4\u503c\u662f ",(0,s.jsx)(r.code,{children:"./src/index.js"}),"\uff0c\u4f46\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728 webpack configuration \u4e2d\u914d\u7f6e ",(0,s.jsx)(r.code,{children:"entry"})," \u5c5e\u6027\uff0c\u6765\u6307\u5b9a",(0,s.jsx)(r.code,{children:"\u4e00\u4e2a\uff08\u6216\u591a\u4e2a\uff09\u4e0d\u540c\u7684\u5165\u53e3\u8d77\u70b9"}),"\u3002\u4f8b\u5982\uff1a"]}),"\n",(0,s.jsx)(r.h4,{id:"webpackconfigjs",children:"webpack.config.js"}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"\u5355\u5165\u53e3\u6587\u4ef6\u914d\u7f6e"}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"const path = require('path') //nodejs\u6a21\u5757 \u5904\u7406\u8def\u5f84\u7684\r\n//\u91c7\u53d6\u76f8\u5bf9\u8def\u5f84\r\nmodule.exports = {\r\n  entry: './path/to/my/entry/file.js'\r\n}\r\n\r\n// \u5229\u7528path\u6a21\u5757\r\n/**\r\n * \u914d\u7f6e\u6a21\u5757\u5bfc\u51fa\r\n *\r\n * \u8be5\u6a21\u5757\u5bfc\u51fa\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5305\u542b\u4e86\u9879\u76ee\u7684\u5165\u53e3\u914d\u7f6e\u4fe1\u606f\u3002\r\n * \u5176\u4e2d\uff0centry\u5c5e\u6027\u6307\u5b9a\u4e86\u9879\u76ee\u7684\u5165\u53e3\u6587\u4ef6\u8def\u5f84\uff0c\u8fd9\u662fWebpack\u5f00\u59cb\u6784\u5efa\u7684\u8d77\u70b9\u3002\r\n */\r\nmodule.exports = {\r\n  entry: path.resolve(__dirname, 'src/index.js')\r\n}\r\n\r\n// \u5bf9\u8c61\u5f62\u5f0f\u914d\u7f6e\r\nmodule.exports = {\r\n  entry: {\r\n    main: './path/to/my/entry/file.js'\r\n  }\r\n}\n"})}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"\u591a\u5165\u53e3\u6587\u4ef6\u914d\u7f6e"}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"const path = require('path')\r\nconst entryList = ['./src/file_1.js', './src/file_2.js'].map(item => path.resolve(__dirname, item))\r\nmodule.exports = {\r\n  entry: entryList,\r\n  output: {\r\n    filename: 'bundle.js'\r\n  }\r\n}\r\n\r\n// \u5bf9\u8c61\u8bed\u6cd5 \u7528\u6cd5\uff1aentry: { <entryChunkName> string | [string] } | {}\r\nmodule.exports = {\r\n  entry: {\r\n    app: './src/app.js',\r\n    adminApp: './src/adminApp.js'\r\n  }\r\n}\n"})}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"\u5177\u4f53\u4ee3\u7801"}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"// \u8def\u5f84\u6a21\u5757 \u4e13\u95e8\u5904\u7406\u8def\u5f84\u7684\r\nconst path = require('path')\r\n// \u64cd\u4f5c\u7cfb\u7edf\u6a21\u5757\r\nconst os = require('os')\r\n// terser \u538b\u7f29js\u4ee3\u7801\r\nconst TerserPlugin = require('terser-webpack-plugin')\r\n// \u5f15\u5165eslint\u63d2\u4ef6\r\nconst ESLintPlugin = require('eslint-webpack-plugin')\r\n// const { Generator } = require('webpack')\r\n\r\n// html\u63d2\u4ef6 \u4f5c\u7528\uff1a\u81ea\u52a8\u751f\u6210html\u6587\u4ef6\uff0c\u5e76\u5f15\u5165\u6253\u5305\u540e\u7684js\u6587\u4ef6\r\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\r\n\r\n// \u538b\u7f29css \u63d2\u4ef6 \u4f5c\u7528 \u4f5c\u7528\uff1a\u538b\u7f29css\r\nconst MiniCssExtractPlugin = require('mini-css-extract-plugin')\r\n\r\n// \u63d0\u53d6css \u63d2\u4ef6 \u4f5c\u7528\uff1a\u63d0\u53d6css\u4ee3\u7801\r\nconst CssMinimizeCssPlugin = require('css-minimizer-webpack-plugin') // \u538b\u7f29css\r\n\r\n// \u538b\u7f29\u56fe\u7247\u63d2\u4ef6\r\nconst ImageMinimizerPlugin = require('image-minimizer-webpack-plugin')\r\n\r\nconst threads = os.cpus().length // \u83b7\u53d6cpu\u6838\u6570\r\nfunction getSyleLoader(pre) {\r\n  return [\r\n    MiniCssExtractPlugin.loader,\r\n    'css-loader',\r\n    // css\u517c\u5bb9\u4f4e\u7248\u672c\u6d4f\u89c8\u5668\r\n    {\r\n      loader: 'postcss-loader',\r\n      options: {\r\n        postcssOptions: {\r\n          plugins: ['postcss-preset-env']\r\n        }\r\n      }\r\n    },\r\n    ...(pre && [pre])\r\n  ]\r\n}\r\n\r\nmodule.exports = {\r\n  // \u5165\u53e3 \u76f8\u5bf9\r\n  entry: './src/main.js',\r\n  // \u8f93\u51fa\r\n  output: {\r\n    // \u8f93\u51fa\u8def\u5f84 \u7edd\u5bf9\u8def\u5f84\r\n    // __dirname \u5f53\u524d\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84 \u5f53\u524d\u6587\u4ef6\u5939\u7684\u7edd\u5bf9\u8def\u5f84\r\n    path: path.resolve(__dirname, '../dist'),\r\n    // path: undefined,\r\n    // \u8f93\u51fa\u6587\u4ef6\u540d\r\n    // \u5165\u53e3\u6587\u4ef6\u540d \u6253\u51fa\u8f93\u51fa\u6587\u4ef6\u540d\r\n    filename: 'js/bundle.js',\r\n    // \u8f93\u51fa\u6587\u4ef6\u540d \u6253\u5305\u540e\u7684\u6587\u4ef6\u540d\r\n    chunkFilename: 'static/js/[name].chunk.js',\r\n    // \u56fe\u7247\r\n    assetModuleFilename: 'static/images/[hash:10][ext][query]', // \u8f93\u51fa\u56fe\u7247\u540d\u79f0\r\n    // \u5220\u9664dist\u6587\u4ef6\u5939\r\n    clean: true\r\n  },\r\n  // \u52a0\u8f7d\u5668\r\n  module: {\r\n    rules: [\r\n      {\r\n        // \u5339\u914d\u6587\u4ef6 \u5339\u914d\u540e\u7f00\u540d\r\n        oneOf: [\r\n          {\r\n            test: /\\.css$/, // \u5339\u914d\u6587\u4ef6 xxx.css\r\n            // loader \u987a\u5e8f\u4ece\u53f3\u5411\u5de6\u6267\u884c\r\n            // style-loader \u901a\u8fc7\u521b\u5efastyle\u6807\u7b7e\u5c06\u6837\u5f0f\u653e\u5165html\u4e2d\r\n            // css-loader \u5c06css\u8d44\u6e90\u7f16\u8bd1\u6210commonjs\u6a21\u5757\u5230js\u4e2d\r\n            // 1.loader\u7684\u914d\u7f6e\r\n            use: getSyleLoader()\r\n          },\r\n          //   less-loader \u5c06less\u6587\u4ef6\u7f16\u8bd1\u6210css\u6587\u4ef6\r\n          {\r\n            test: /\\.les s$/i,\r\n            use: getSyleLoader('less')\r\n          },\r\n          //   sass-loader \u5c06sass\u6587\u4ef6\u7f16\u8bd1\u6210css\u6587\u4ef6\r\n          {\r\n            test: /\\.s[ac]ss$/i,\r\n            use: getSyleLoader('sass')\r\n          },\r\n          //  \u56fe\u7247\r\n          {\r\n            test: /\\.(png|jpg|gif)$/i,\r\n            type: 'asset',\r\n            parser: {\r\n              // \u914d\u7f6e\u56fe\u7247\u5927\u5c0f\r\n              dataUrlCondition: {\r\n                // \u5c0f\u4e8e8kb\u7684\u56fe\u7247\u8f6cbase64\r\n                // \u4f18\u70b9: \u51cf\u5c11\u8bf7\u6c42\u6570\u91cf \u7f3a\u70b9: \u5927\u6587\u4ef6\u4f1a\u53d8base64\r\n                maxSize: 8 * 1024 // 8kb\r\n              }\r\n            },\r\n            generator: {\r\n              filename: 'static/images/[name].[hash:10][ext]'\r\n            }\r\n          },\r\n          // \u5b57\u4f53 \u56fe\u6807\r\n          {\r\n            test: /\\.(ttf|woff2?|mp4|mp3|avi)$/,\r\n            type: 'asset/resource'\r\n            // generator: {\r\n            //   filename: 'static/media/[name].[hash:10][ext]'\r\n            // }\r\n          },\r\n          // babel \u517c\u5bb9\u6027\u5904\u7406\r\n          {\r\n            test: /\\.js$/,\r\n            exclude: /node_modules/,\r\n            use: [\r\n              // \u7ebf\u7a0b\u6c60 \u4f18\u5316loader\u6267\u884c\r\n              {\r\n                loader: 'thread-loader',\r\n                options: {\r\n                  workers: threads // \u8fdb\u7a0b\u6570\u91cf\r\n                }\r\n              },\r\n              {\r\n                loader: 'babel-loader',\r\n                options: {\r\n                  presets: [\r\n                    '@babel/preset-env',\r\n                    {\r\n                      useBuiltIns: 'usage', // \u6309\u9700\u52a0\u8f7d\r\n                      corejs: 3\r\n                    }\r\n                  ],\r\n\r\n                  plugins: ['@babel/plugin-transform-runtime'] // \u51cf\u5c11\u4ee3\u7801\u4f53\u79ef\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  // \u63d2\u4ef6\r\n  plugins: [\r\n    new ESLintPlugin({\r\n      // \u68c0\u6d4b\u89c4\u5219 context \u68c0\u6d4b\u7684\u76ee\u5f55\r\n      context: path.resolve(__dirname, '../src'),\r\n      // \u68c0\u6d4b\u6392\u9664\u9879\r\n      exclude: 'node_modules',\r\n      cache: true, // \u5f00\u542f\u7f13\u5b58\r\n      // \u7f13\u5b58\u8def\u5f84\r\n      cacheLocation: path.resolve(__dirname, 'node_modules/.cache/.eslintcache')\r\n    }),\r\n    new HtmlWebpackPlugin({\r\n      // \u4ee5\u6e90\u6587\u4ef6\u521b\u5efa html\u6587\u4ef6\r\n      // \u6a21\u677f\u6587\u4ef6 \u81ea\u52a8\u5f15\u5165\u6253\u5305\u8f93\u51fa\u7684\u6240\u6709\u8d44\u6e90\r\n      template: path.resolve(__dirname, '../public/index.html')\r\n    }),\r\n    // \u63d0\u53d6css \u6837\u5f0f \u6837\u5f0f\u6587\u4ef6\r\n    new MiniCssExtractPlugin({\r\n      filename: 'static/css/main.css',\r\n      chunkFilename: 'static/css/[name].chunk.css'\r\n    }),\r\n    // \u56fe\u7247\u538b\u7f29\r\n    new ImageMinimizerPlugin({\r\n      // \u538b\u7f29\u56fe\u7247\r\n      minimizer: {\r\n        implementation: ImageMinimizerPlugin.imageminGenerate,\r\n        options: {\r\n          plugins: [\r\n            // gif\u538b\u7f29\r\n            ['gifsicle', { interlaced: true }],\r\n            // jpg\u538b\u7f29\r\n            ['jpegtran', { progressive: true }],\r\n            // png\u538b\u7f29\r\n            ['optipng', { optimizationLevel: 5 }],\r\n            // svg\u538b\u7f29\r\n            ['svgo', { name: 'preset-default' }]\r\n            // ['webp', { quality: 75 }]\r\n          ]\r\n        }\r\n      }\r\n    })\r\n  ],\r\n  optimiza: {\r\n    // \u538b\u7f29css\r\n    minimizer: [\r\n      // \u538b\u7f29css\r\n      new CssMinimizeCssPlugin(),\r\n      // \u538b\u7f29js\r\n      new TerserPlugin({\r\n        parallel: threads // \u7ebf\u7a0b\u6c60\r\n      })\r\n    ]\r\n  },\r\n  optimization: {\r\n    splitChunks: {\r\n      chunks: 'all', //\u5bf9\u6240\u6709\u6a21\u5f0f\u8fdb\u884c\u5206\u5272\r\n      cacheGroups: {\r\n        // \u7f13\u5b58\u7ec4\r\n        commons: {\r\n          name: 'commons', // \u62bd\u79bb\u51fa\u6765\u7684\u6587\u4ef6\u540d\r\n          chunks: 'initial', // \u53ea\u5bf9\u5165\u53e3\u6587\u4ef6\u8fdb\u884c\u5206\u5272\r\n          minSize: 0, // \u5206\u5272\u6700\u5c0f\u5b57\u8282\r\n          minChunks: 2 // \u6700\u5c11\u88ab\u5f15\u7528\u6b21\u6570\r\n        }\r\n      }\r\n    },\r\n    // \u8fd0\u884c chunks\r\n    runtimeChunk: {\r\n      name: entrypoint => `runtime~${entrypoint.name}.js`\r\n    }\r\n  },\r\n\r\n  // \u6a21\u5f0f\r\n  mode: 'development',\r\n  // stats\r\n  stats: {\r\n    children: true\r\n  }\r\n}\n"})})]})}function d(n={}){const{wrapper:r}={...(0,t.R)(),...n.components};return r?(0,s.jsx)(r,{...n,children:(0,s.jsx)(p,{...n})}):p(n)}},8453:(n,r,e)=>{e.d(r,{R:()=>a,x:()=>c});var s=e(6540);const t={},i=s.createContext(t);function a(n){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(r):{...r,...n}}),[r,n])}function c(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(i.Provider,{value:r},n.children)}}}]);